% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hankel.R
\name{hankel_dmd}
\alias{hankel_dmd}
\title{Hankel-DMD (Krylov Subspace Method)}
\usage{
hankel_dmd(y, delays = NULL, rank = NULL, dt = 1)
}
\arguments{
\item{y}{Numeric vector or matrix. For vector: a scalar time series.
For matrix: rows are observables, columns are time points.}

\item{delays}{Integer; number of time delays to use (embedding dimension - 1).
If NULL (default), automatically selected based on data length.}

\item{rank}{Integer; rank for SVD truncation. If NULL (default),
automatically selected to capture 99\% of variance.}

\item{dt}{Numeric; time step between observations. Default is 1.}
}
\value{
An object of class \code{c("hankel_dmd", "dmd")} containing:
\describe{
\item{A}{The DMD matrix (Koopman operator approximation)}
\item{modes}{Complex matrix of DMD modes}
\item{eigenvalues}{Complex vector of DMD eigenvalues}
\item{amplitudes}{Complex vector of initial mode amplitudes}
\item{rank}{Integer; the rank used for truncation}
\item{delays}{Number of delays used in Hankel matrix}
\item{hankel}{The Hankel-Takens matrix}
\item{companion}{The companion matrix (if computed)}
\item{residual}{Residual norm for error assessment}
\item{svd}{List containing truncated SVD components}
\item{y_original}{Original time series data}
\item{dt}{Time step}
}
}
\description{
Performs Dynamic Mode Decomposition using time-delayed observables
forming a Krylov subspace. This method avoids the curse of dimensionality
that affects standard EDMD with polynomial/RBF basis functions.
}
\details{
The Hankel-DMD method constructs a Hankel (Takens) matrix from time-delayed
copies of the observable:
\deqn{H = \begin{bmatrix} y_1 & y_2 & \cdots & y_n \\
                          y_2 & y_3 & \cdots & y_{n+1} \\
                          \vdots & & & \vdots \\
                          y_m & y_{m+1} & \cdots & y_{m+n-1}
      \end{bmatrix}}

This is equivalent to using the Krylov sequence \eqn{(f, Uf, U^2f, \ldots)}
as the basis for the finite section approximation.
}
\section{Advantages over Standard DMD}{

\itemize{
\item Avoids curse of dimensionality: basis size equals number of delays,
not exponential in state dimension
\item Natural choice of observables selected by the dynamics
\item Proven pseudospectral convergence for systems with pure point spectrum
\item Connected to Takens' embedding theorem for attractor reconstruction
}
}

\section{Theoretical Background}{

This implementation is based on Section 5 of Mezic (2020), which shows that
Krylov subspace methods provide pseudospectral convergence without requiring
an exponentially large basis. The companion matrix representation (eq. 83)
captures the dynamics in the time-delay coordinate system.
}

\examples{
# Scalar time series from oscillator
t <- seq(0, 20, by = 0.1)
y <- cos(2 * pi * 0.1 * t) + 0.5 * sin(2 * pi * 0.25 * t)

# Fit Hankel-DMD
model <- hankel_dmd(y, delays = 10)
print(model)

# Check eigenvalues (should reveal frequencies)
spectrum <- dmd_spectrum(model, dt = 0.1)
print(spectrum)

# Predict future values
future <- predict(model, n_ahead = 50)

# Multivariate time series
X <- rbind(cos(t), sin(t))
model_mv <- hankel_dmd(X, delays = 5)

}
\references{
Mezic, I. (2020). On Numerical Approximations of the Koopman Operator.
arXiv:2009.05883, Section 5.

Arbabi, H. and Mezic, I. (2017). Ergodic theory, dynamic mode decomposition,
and computation of spectral properties of the Koopman operator.
SIAM Journal on Applied Dynamical Systems, 16(4):2096-2126.

Takens, F. (1981). Detecting strange attractors in turbulence.
In Dynamical Systems and Turbulence, pages 366-381. Springer.
}
\seealso{
\code{\link[=dmd]{dmd()}} for standard DMD, \code{\link[=dmd_spectrum]{dmd_spectrum()}} for eigenvalue analysis,
\code{\link[=predict.dmd]{predict.dmd()}} for forecasting.
}
