% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dmd.R
\name{dmd}
\alias{dmd}
\title{Dynamic Mode Decomposition}
\usage{
dmd(X, rank = NULL, center = FALSE)
}
\arguments{
\item{X}{A numeric matrix where rows represent state variables and columns
represent time snapshots. Must have at least 2 rows and 3 columns.}

\item{rank}{Integer specifying the rank for SVD truncation. If \code{NULL}
(default), rank is automatically selected to capture 99\% of variance.}

\item{center}{Logical; if \code{TRUE}, the data is centered by subtracting the
row means before analysis. Default is \code{FALSE}.}
}
\value{
An object of class \code{"dmd"} containing:
\describe{
\item{A}{The DMD matrix (Koopman operator approximation) in the original
state space. Multiplying a state by A gives the predicted next state.}
\item{modes}{Complex matrix of DMD modes (columns). Each mode represents
a spatial pattern that evolves with a single frequency and growth rate.}
\item{eigenvalues}{Complex vector of DMD eigenvalues. The magnitude
indicates growth/decay rate; the angle indicates oscillation frequency.}
\item{amplitudes}{Complex vector of initial mode amplitudes, computed
by projecting the first snapshot onto the modes.}
\item{rank}{Integer; the rank used for truncation.}
\item{svd}{List containing truncated SVD components (U, S, V).}
\item{A_tilde}{The reduced DMD matrix in the SVD coordinate system.}
\item{X_first}{First column of input data (initial condition).}
\item{X_last}{Last column of input data (for prediction initialization).}
\item{data_dim}{Dimensions of the input matrix (rows, columns).}
\item{center}{Logical; whether centering was applied.}
\item{X_mean}{Row means if centering was applied, otherwise NULL.}
\item{dt}{Time step (currently set to 1; for future extension).}
\item{call}{The matched function call.}
}
}
\description{
Performs Dynamic Mode Decomposition (DMD) on time-series data to extract
spatiotemporal modes, eigenvalues, and a linear operator approximating
the system dynamics.
}
\details{
DMD approximates the dynamics of a system by finding the best-fit linear
operator \eqn{A} such that \eqn{X_2 \approx A X_1}, where \eqn{X_1} and
\eqn{X_2} are time-shifted versions of the data.

The algorithm:
\enumerate{
\item Splits data into \eqn{X_1 = X[, 1:(n-1)]} and \eqn{X_2 = X[, 2:n]}
\item Computes truncated SVD of \eqn{X_1}: \eqn{X_1 = U \Sigma V^T}
\item Projects onto reduced coordinates: \eqn{\tilde{A} = U^T X_2 V \Sigma^{-1}}
\item Computes eigendecomposition of \eqn{\tilde{A}}
\item Recovers full-space modes: \eqn{\Phi = X_2 V \Sigma^{-1} W}
}
}
\section{Interpreting Results}{

\itemize{
\item \strong{Eigenvalue magnitude < 1}: Mode is decaying (stable)
\item \strong{Eigenvalue magnitude = 1}: Mode is neutral (marginally stable)
\item \strong{Eigenvalue magnitude > 1}: Mode is growing (unstable)
\item \strong{Eigenvalue phase}: Determines oscillation frequency as \eqn{\omega = \arg(\lambda) / \Delta t}
}
}

\examples{
# Create a simple oscillatory system
t <- seq(0, 10, by = 0.1)
x1 <- cos(2 * pi * 0.5 * t)
x2 <- sin(2 * pi * 0.5 * t)
X <- rbind(x1, x2)

# Fit DMD model
model <- dmd(X)

# Examine the model
print(model)
summary(model)

# Check eigenvalue magnitudes (should be ~1 for oscillatory system)
Mod(model$eigenvalues)

}
\references{
Schmid, P. J. (2010). Dynamic mode decomposition of numerical and
experimental data. Journal of Fluid Mechanics, 656, 5-28.
}
\seealso{
\code{\link[=predict.dmd]{predict.dmd()}} for forecasting, \code{\link[=dmd_spectrum]{dmd_spectrum()}} for eigenvalue
analysis, \code{\link[=dmd_reconstruct]{dmd_reconstruct()}} for data reconstruction.
}
