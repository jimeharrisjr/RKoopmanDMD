% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analysis.R
\name{dmd_residual}
\alias{dmd_residual}
\title{Compute DMD Residual for Error Assessment}
\usage{
dmd_residual(object, X_original = NULL)
}
\arguments{
\item{object}{A \code{"dmd"} or \code{"hankel_dmd"} object.}

\item{X_original}{Optional; the original data matrix. If not provided,
uses stored data from the model (if available).}
}
\value{
A list containing:
\describe{
\item{residual_norm}{Overall Frobenius norm of residual}
\item{residual_relative}{Residual norm relative to data norm}
\item{per_step_residual}{Vector of residual norms at each time step}
\item{per_mode_residual}{Vector of residual contributions per mode}
\item{pseudospectral_bound}{Upper bound on pseudospectral radius (epsilon)}
\item{residual_matrix}{Full residual matrix (X_pred - X_true)}
}
}
\description{
Computes the residual of the DMD approximation, which measures how well
the finite-dimensional approximation captures the true Koopman operator.
Based on the error analysis in Mezic (2020), Section 4.3 and 5.2.
}
\details{
The residual measures the error in the finite section approximation:
\deqn{r = U\tilde{\phi} - \tilde{\lambda}\tilde{\phi}}

From Proposition 4.1 in Mezic (2020):
\deqn{U\tilde{\phi} - \tilde{\lambda}\tilde{\phi} = \tilde{e} \cdot (U\tilde{f} - P_{\tilde{F}}U\tilde{f})}

The pseudospectral bound \eqn{\epsilon} satisfies:
\deqn{|U\tilde{e} \cdot \tilde{f} - \tilde{\lambda}\tilde{e} \cdot \tilde{f}| = |e_N r|}

This means the computed eigenvalues are in the \eqn{\epsilon}-pseudospectrum
of the true Koopman operator.
}
\examples{
t <- seq(0, 10, by = 0.1)
X <- rbind(cos(t), sin(t))
model <- dmd(X)
res <- dmd_residual(model, X)
cat("Relative residual:", res$residual_relative, "\n")
cat("Pseudospectral bound:", res$pseudospectral_bound, "\n")

}
\references{
Mezic, I. (2020). On Numerical Approximations of the Koopman Operator.
arXiv:2009.05883, Sections 4.3 and 5.2.
}
\seealso{
\code{\link[=dmd_error]{dmd_error()}} for reconstruction error metrics,
\code{\link[=dmd_pseudospectrum]{dmd_pseudospectrum()}} for pseudospectral analysis.
}
