% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gla.R
\name{gla}
\alias{gla}
\title{Generalized Laplace Analysis (GLA)}
\usage{
gla(y, eigenvalues = NULL, n_eigenvalues = 5, tol = 1e-06, max_iter = NULL)
}
\arguments{
\item{y}{Numeric vector or matrix of trajectory data. For vector: a scalar
time series. For matrix: rows are observables, columns are time points.}

\item{eigenvalues}{Complex vector of candidate eigenvalues to test.
If NULL (default), eigenvalues are estimated from a preliminary DMD.}

\item{n_eigenvalues}{Integer; if eigenvalues is NULL, how many eigenvalues
to estimate from preliminary DMD. Default is 5.}

\item{tol}{Numeric; convergence tolerance for the time average.
Default is 1e-6.}

\item{max_iter}{Maximum number of iterations (time steps) to use.
Default is NULL (use all available data).}
}
\value{
An object of class \code{"gla"} containing:
\describe{
\item{eigenvalues}{Complex vector of eigenvalues used}
\item{eigenfunctions}{Matrix of eigenfunction values at each time point}
\item{modes}{Complex matrix of Koopman modes (projection coefficients)}
\item{convergence}{Logical vector indicating which eigenvalues converged}
\item{residuals}{Residual norms for each eigenvalue}
\item{n_iter}{Number of iterations used}
}
}
\description{
Computes Koopman eigenfunctions and modes using Generalized Laplace Analysis,
which constructs eigenfunctions directly from trajectory data via weighted
time averages without constructing an approximate operator matrix.
}
\details{
The GLA method computes eigenfunctions using Theorem 3.1 from Mezic (2020):
\deqn{f_k = \lim_{n\to\infty} \frac{1}{n} \sum_{i=0}^{n-1} \lambda_k^{-i}
  \left(f(T^i x) - \sum_{j=0}^{k-1} \lambda_j^i \phi_j(x) s_j\right)}

where \eqn{\phi_k} is the eigenfunction associated with \eqn{\lambda_k} and
\eqn{s_k} is the Koopman mode.
}
\section{Advantages}{

\itemize{
\item Does not require construction of an approximate operator matrix
\item Works directly with trajectory data
\item Can be more robust for systems where eigenvalues are known/estimated
\item Avoids issues with basis selection
}
}

\section{Limitations}{

\itemize{
\item Requires eigenvalues to be known or estimated separately
\item Can be numerically unstable for eigenvalues with |Î»| > 1
\item Convergence may be slow for eigenvalues near the unit circle
}
}

\examples{
# Simple oscillator
t <- seq(0, 50, by = 0.1)
y <- cos(2 * pi * 0.1 * t) + 0.5 * sin(2 * pi * 0.3 * t)

# GLA with automatic eigenvalue estimation
result <- gla(y, n_eigenvalues = 4)
print(result)

# GLA with known eigenvalues
dt <- 0.1
omega1 <- 2 * pi * 0.1
omega2 <- 2 * pi * 0.3
known_eigs <- c(exp(1i * omega1 * dt), exp(-1i * omega1 * dt),
                 exp(1i * omega2 * dt), exp(-1i * omega2 * dt))
result2 <- gla(y, eigenvalues = known_eigs)

}
\references{
Mezic, I. (2020). On Numerical Approximations of the Koopman Operator.
arXiv:2009.05883, Section 3.

Mezic, I. and Banaszuk, A. (2004). Comparison of systems with complex
behavior. Physica D, 197(1-2):101-133.
}
\seealso{
\code{\link[=dmd]{dmd()}} for matrix-based decomposition, \code{\link[=hankel_dmd]{hankel_dmd()}} for
Krylov subspace methods.
}
